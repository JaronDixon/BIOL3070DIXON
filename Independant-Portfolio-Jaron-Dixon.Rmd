---
title: "Individual Portfolio"
author: "Jaron Dixon"
date: "`r Sys.Date()`"
output:
  github_document: 
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)
library(viridis)  
library(ggridges)
library(broom)
library(tidyverse)
heart_data <- read.csv("heart_attack_dataset_age-1.csv")
```

# ABSTRACT
Heart attacks affect approximately 805,000 Americans annually, showing the importance to understand factors that contribute to increased cardiovascular risk. Previous research indicates that chronic stress can heighten inflammation, promote arterial plaque buildup, and elevate blood pressure through increased hormone release, ultimately leading to more risk of cardiac events. Stress is particularly prevalent among individuals pursuing higher education, as both undergraduate and postgraduate students face academic, professional, and personal pressures that may contribute to long-term stress. Additionally, gender has been identified as a potential risk factor, with men experiencing heart attacks at roughly twice the rate of women, suggesting a possibly protective hormonal differences. Given these observations, this study examines how stress levels, educational status, and gender may interact to influence the likelihood of experiencing a heart attack. The results conclude no correlation between these factors and the presence of an individual having a heart attack. This continues our search to find a potential risk factor for heart attacks. 

# BACKGROUND
Every year about 805,000 Americans have a heart attack (Tsao et al., 2023). A heart attack can pose pain from a mild discomfort to severe crushing pain (Kulkarni, 2025). This health risk has become like a ticking bomb being able to strike anyone. With this disease that has the ability to strike a variety of different individuals, research has begun to try and predict risk factors or conditions that can cause an individual to be more susceptible to having a heart attack. Long-term or chronic stress can lead to higher levels of inflammation in the body which leads to more plaque buildup in the arteries (Katella, 2024). Additionally, stress also causes hormones such as adrenaline (Katella, 2024). Adrenaline increases mental alertness and the heart beats faster and raises blood pressure (Katella, 2024). Prolonged stress leads to heart damage. 

With this in mind we turn to what might cause an individual to have prolonged stress. Specifically, undergraduate students often experience stress related to adapting to higher education and managing coursework (Pérez-Jorge, 2025). Postgraduate students also exhibit stress about advanced research, thesis completion, and balancing academic work and professional responsibilities (Pérez-Jorge, 2025). When it comes to pursuing higher education there are a lot of stressful responsibilities for individuals. This could be a cause of having a risk of heart attacks because of the impact of the stress on the body. 

Another factor that might contribute to a higher risk of heart attacks is gender. Researchers have found that men are twice as likely to have a heart attack than women (Harvard Health Publishing, 2016). There is also some suspicion that hormones in women before menopause cause more defense for women against heart attacks (Harvard Health Publishing, 2016). 

Knowing this information brings a lot of question of how much factors like stress, gender, or education could lead to an individual being more likely to have a heart attack. 


# STUDY QUESTION and HYPOTHESIS


## Questions  

Do certain factors cause a increased chance in having a heart attack?

## Hypothesis 

If the person is male, have high stress level, and have a post-graduate education level, then we expect to see an increase in likelihood of heart attacks.
  
## Prediction
We expect to see people who are male, that have a post graduate degree, and who are under high stress to experience the highest chance of obtaining a heart attack.

# Methods
The data for this study were taken from the Kaggle Heart Attack Prediction dataset and imported into R for analysis. The variables used included the following: StressLevel, Gender, EducationLevel, and Outcome (heart attack vs. no heart attack). Each variable was cleaned and converted into the appropriate format for statistical testing.

Depending on the type of data being compared, different tests were utilized accordingly. In order to see if StressLevel was related to heart attack outcome, a logistic regression was performed because it is appropriate for a numeric predictor and a binary outcome. Chi-square tests were used to test whether EducationLevel or Gender were associated with heart attack occurrence since these variables are categorical. Fisher's Exact Test was used instead when expected cell counts were too small for Chi-square assumptions.

After individually testing each variable, a multivariable logistic regression was run to consider the combined impacts StressLevel, Gender, and EducationLevel have on heart attack occurrence. This allowed us to see whether these variables, taken together, improved the prediction of heart attack risk. Bar plots, violin plots, jitter plots, and heat maps were created to support the statistical results.

# Results

## Figures

```{r Heart Attack Vs Education Level Side by Side Bar Plot, eval=TRUE}

# Summarize counts
edu_counts <- heart_data %>%
  group_by(EducationLevel, Outcome) %>%
  summarise(count = n(), .groups = "drop")

# Ensure order of education levels
edu_counts$EducationLevel <- factor(
  edu_counts$EducationLevel,
  levels = c("High School", "College", "Postgraduate")
)

# Side-by-side bar plot
ggplot(edu_counts, aes(x = EducationLevel, y = count, fill = Outcome)) +
  geom_col(position = position_dodge(width = 0.8), width = 0.7) +
  scale_fill_manual(values = c(
    "No Heart Attack" = "lightblue3",
    "Heart Attack" = "indianred2"
  )) +
  labs(
    title = "Heart Attack Outcomes by Education Level",
    x = "Education Level",
    y = "Count of Individuals",
    fill = "Heart Attack Outcome"
  ) +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

```

```{r Heart Attack vs StressLevel Violin Plot, eval=TRUE}
ggplot(heart_data, aes(x = Outcome, y = StressLevel, fill = Outcome)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  geom_boxplot(width = 0.1, fill = "white", alpha = 0.5) +
  labs(
    title = "Stress Levels by Heart Attack Outcome",
    x = "Heart Attack Outcome",
    y = "Stress Level (1–9)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none"
  )

```
```{r Stress vs Heart Attack Ridge Plot UNUSED, eval=TRUE }

ggplot(heart_data, aes(x = StressLevel, y = Outcome, fill = Outcome)) +
  geom_density_ridges(alpha = 0.7, color = "black", scale = 1) +
  scale_fill_manual(values = c("No Heart Attack" = "lightblue3", "Heart Attack" = "indianred2")) +
  labs(
    title = "Distribution of Stress Levels by Heart Attack Outcome",
    x = "Stress Level (1–9)",
    y = "Heart Attack Outcome",
    fill = "Outcome"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "none",
    axis.title.y = element_text(face = "bold"),
    axis.title.x = element_text(face = "bold")
  )
```


```{r Gender vs Heart Attack Heat Plot, eval=TRUE}

# Summarize counts
gender_counts <- heart_data %>%
  group_by(Gender, Outcome) %>%
  summarise(count = n(), .groups = "drop")

#Heat map
ggplot(gender_counts, aes(x = Gender, y = Outcome, fill = count)) +
  geom_tile(color = "white", linewidth = 0.8) +  # white borders between tiles
  geom_text(aes(label = count), color = "white", size = 6, fontface = "bold") +
  scale_fill_viridis(option = "C", direction = -1) +  # smooth and modern gradient
  labs(
    title = "Heart Attack Outcomes by Gender",
    x = "Gender",
    y = "Heart Attack Outcome",
    fill = "Count"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 20),
    axis.text = element_text(face = "bold", size = 14),
    axis.title = element_text(face = "bold", size = 16),
    legend.title = element_text(face = "bold", size = 14),
    legend.text = element_text(size = 12)
  )
```

```{r Stress Levels, Education Level, Gender and Heart Attack combined plot, eval=TRUE}

ggplot(heart_data, aes(
  x = EducationLevel,
  y = StressLevel,
  color = Outcome,       
  alpha = Outcome,  
  shape = Gender
)) +
  geom_jitter(width = 0.3, size = 4) +
  scale_alpha_manual(values = c("No Heart Attack" = .9, "Heart Attack" = 1)) +
  scale_shape_manual(values = c("Female" = 1, "Male" = 16)) +  # hollow vs filled
  scale_color_manual(values = c("No Heart Attack" = "lightblue3", "Heart Attack" = "indianred2")) + 
  labs(
    title = "Stress Levels by Education, Gender, and Heart Attack Outcome",
    x = "Education Level",
    y = "Stress Level (1–9)",
    color = "Heart Attack Outcome",
    alpha = "Heart Attack Outcome",
    shape = "Gender"
  ) +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold")
  )

```

## Statistical Analyses

```{r Stress Levels vs Heart Attack Logistic Regression, eval=TRUE}

heart_data$Outcome <- factor(heart_data$Outcome, levels = c("No Heart Attack", "Heart Attack"))

# Fit logistic regression model
stress_model <- glm(Outcome ~ StressLevel, data = heart_data, family = binomial)

# View model summary
summary(stress_model)

# Calculate Odds Ratios and 95% Confidence Intervals
odds_ratios <- exp(cbind(OR = coef(stress_model), confint(stress_model)))
print(odds_ratios)

# Extract tidy model output for p-value
model_stats <- tidy(stress_model)
p_value <- model_stats$p.value[2]  
cat("P-value for Stress Level:", round(p_value, 4), "\n")

# Create data for predicted probabilities
pred_data <- data.frame(
  StressLevel = seq(min(heart_data$StressLevel),
                    max(heart_data$StressLevel), length.out = 100)
)
pred_data$PredictedProb <- predict(stress_model, newdata = pred_data, type = "response")

# Plot predicted probability curve with dotted points
ggplot() +
  geom_jitter(data = heart_data, aes(x = StressLevel, y = as.numeric(Outcome) - 1),
              width = 0.15, alpha = 0.5, shape = 21, color = "black", fill = "grey80") +
  geom_line(data = pred_data, aes(x = StressLevel, y = PredictedProb),
            color = "red", size = 1.2) +
  geom_rug(data = heart_data, aes(x = StressLevel), sides = "b", alpha = 0.3) +
  labs(
    title = paste0(
      "Predicted Probability of Heart Attack by Stress Level\n",
      "p-value = ", round(p_value, 4)
    ),
    x = "Stress Level (1–9)",
    y = "Predicted Probability of Heart Attack"
  ) +
  theme_minimal(base_size = 14)
```



```{r Education Level vs Heart Attack Chi Squared, eval=TRUE}
# Create a contingency table of counts
edu_table <- table(heart_data$EducationLevel, heart_data$Outcome)
print("Contingency Table:")
print(edu_table)

# Perform Chi-Square Test
chi_result <- chisq.test(edu_table)
print("Chi-Square Test Results:")
print(chi_result)
```

```{r Gender vs Heart Attack Chi Squared, eval=TRUE}
# Create contingency table
gender_table <- table(heart_data$Gender, heart_data$Outcome)
print("Contingency Table:")
print(gender_table)

# Run Chi-Square Test
chi_gender <- chisq.test(gender_table)
print("Chi-Square Test Results:")
print(chi_gender)

# Display expected counts
print("Expected Counts:")
print(chi_gender$expected)

# If Chi-Square assumptions are violated (expected counts < 5), run Fisher's Exact Test
if(any(chi_gender$expected < 5)) {
  print("Expected counts too low — running Fisher's Exact Test instead:")
  fisher_result <- fisher.test(gender_table)
  print(fisher_result)
}
```

```{r Stress Level, Gender, Education Level vs Heart Attack Multivariable Logistic Regression, eval=TRUE}

df <- heart_data %>%
  mutate(
    HeartAttack = factor(
      Outcome,
      levels = c("No Heart Attack", "Heart Attack")
    ),
    
    Gender = factor(Gender, levels = c("Male", "Female")),
    
    Education = factor(
      EducationLevel,
      levels = c("High School", "College", "Postgraduate")
    ),
    
    Stress = as.numeric(StressLevel)
  )

# Logistic regression
model <- glm(
  HeartAttack ~ Gender + Education + Stress,
  data = df,
  family = binomial
)

summary(model)   

# One overall p-value (likelihood ratio test)

model_null <- glm(HeartAttack ~ 1, data = df, family = binomial)

anova(model_null, model, test = "LRT")

```

## Interpretations

### Stress Level vs Heart Attack
Analysis showed no statistically significant association between stress levels and heart attack occurrence (p = 0.297). This suggests that variations in stress level are not strongly linked to the likelihood of experiencing a heart attack. However, this analysis does not account for the potential effects of chronic or long-term stress exposure.

### Education Level vs Heart Attack
Analysis showed no statistically significant relationship between education level and heart attack occurrence (p = 0.554). This indicates that differences in education level are not very likely to cause a change in how likely someone is to have a heart attack.

### Gender Vs Heart Attack 
Analysis showed no statistically significant association between gender and heart attack occurrence (p = 0.672). This suggests that being male or female does not meaningfully influence the likelihood of experiencing a heart attack.

### Stress Level, Education Level, and Gender vs Heart Attack
Analysis showed no statistically significant association between the combined effects of stress levels, education levels, and gender, and heart attack occurrence (p = 0.624). This indicates that, collectively, these factors do not significantly influence heart attack risk.

# DISCUSSION

Limitations in the dataset, rather than the true relationship of these factors with heart attack risk, probably play a greater role in the nonsignificant findings of this study. The stress scores used in the analyses were self-reported and taken at only one moment in time, which likely does not reflect long-term or chronic stress-the type most commonly linked to heart disease. Because of this, the stress measure may not accurately capture the kind of stress that affects cardiovascular health.

On the other hand, education level also may not demonstrate a clear pattern, because its association with heart health is complex. Higher levels of education may increase stressors but, in return, bring about better means of acquiring resources, lower long-term financial stress, and superior healthcare that may balance out the negative effect.

Again, gender may not show strong patterns in this dataset if either the sample is limited, or other important factors such as age or medical history are not included. Gender differences in heart attack risk usually depend on these additional variables.

The findings, therefore, must be interpreted with caution. For instance, the dataset may not provide sufficient information or detail for a full assessment of how stress, gender, and education affect heart attack risk. More comprehensive data would very likely give a fuller picture.

# CONCLUSION

In the present study, we found no evidence that stress level, gender, and education level significantly predict heart attack occurrence in this dataset. These findings should be interpreted with caution, since the measures available-especially the rating of stress-may not adequately reflect the long-term factors that determine cardiovascular health.

Future research should also involve more specific clinical variables like age, cholesterol, blood pressure, and medical history, while also using more valid chronic-stress measures. The inclusion of a larger, more varied sample would also make it clearer whether these factors truly have little impact or whether the limitations of the present dataset prevented meaningful patterns from being found.

# REFERENCES     

1. Harvard Health Publishing. “Throughout Life, Heart Attacks Are Twice as Common in Men than Women - Harvard Health.” Harvard Health, Harvard Health, 8 Nov. 2016, www.health.harvard.edu/heart-health/throughout-life-heart-attacks-are-twice-as-common-in-men-than-women.
2.Katella, Kathy. “Yes, Stress Can Hurt Your Heart: 3 Things to Know.” Yale Medicine, 12 Feb. 2024, www.yalemedicine.org/news/stress-affects-your-heart.
3. Kulkarni, Anandita. “What Does a Heart Attack Feel Like? 8 Warning Signs You Shouldn’t Ignore.” @Bswhealth, 2025, www.bswhealth.com/blog/what-does-a-heart-attack-feel-like-8-warning-signs.
4. Panday, Ankush. “Heart Attack Prediction in United States.” Kaggle.com, 2025, www.kaggle.com/datasets/ankushpanday2/heart-attack-prediction-in-united-states/data. Accessed 6 Nov. 2025.
5. Pérez-Jorge, David, et al. “Examining the Effects of Academic Stress on Student Well-Being in Higher Education.” Humanities and Social Sciences Communications, vol. 12, no. 1, 28 Mar. 2025, pp. 1–13, www.nature.com/articles/s41599-025-04698-y, https://doi.org/10.1057/s41599-025-04698-y.
6. Tsao, Connie W., et al. “Heart Disease and Stroke Statistics—2023 Update: A Report from the American Heart Association.” Circulation, vol. 147, no. 8, 25 Jan. 2023, www.ahajournals.org/doi/10.1161/CIR.0000000000001123, https://doi.org/10.1161/cir.0000000000001123.
7. ChatGPT. OpenAI, Used to help with troubleshooting and editing out any errors in code, along with helping with suggesting what type of plots would be best to use. 




